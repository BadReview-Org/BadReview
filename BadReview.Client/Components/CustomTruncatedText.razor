@if(@Summary != null && Summary.Length > 0)
{
    <div @ref="_textRef">
        <MudText Typo="Typo.body1" Style="@($"line-height: 1.8; color: #e0e0e0; word-wrap: break-word; overflow-wrap: break-word; word-break: break-word; {(_expanded ? "" : "display: -webkit-box; -webkit-line-clamp: 5; -webkit-box-orient: vertical; overflow: hidden;")}")">
            @Summary
        </MudText>
    </div>
    @if (_isTruncated)
    {
        <MudButton OnClick="OnExpandCollapseClick" Variant="Variant.Text" Color="Color.Primary" Size="Size.Small" Class="mt-2">
            @(_expanded ? "Read less" : "Read more..")
        </MudButton>
    }
}   
else
{
    <MudText Typo="Typo.body1" Style="line-height: 1.8; color: #e0e0e0;">
        No description available.
    </MudText>
}

@inject IJSRuntime JS

@code{
    private bool _expanded = false;
    private bool _isTruncated = false;
    private ElementReference _textRef;
    
    [Parameter] public string Summary { get; set; } = "";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && !string.IsNullOrEmpty(Summary))
        {
            await CheckIfTruncated();
        }
    }

    private async Task CheckIfTruncated()
    {
        try
        {
            _isTruncated = await JS.InvokeAsync<bool>("checkIfTruncated", _textRef);
            StateHasChanged();
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error checking truncation: {ex.Message}");
        }
    }

    private void OnExpandCollapseClick()
    {
        _expanded = !_expanded;
    }
}